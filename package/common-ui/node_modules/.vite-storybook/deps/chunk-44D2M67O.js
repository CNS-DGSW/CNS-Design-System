import {
  combineParameters,
  normalizeInputTypes,
  sortStoriesV6,
  userOrAutoTitle
} from "./chunk-5DBMIAOO.js";
import {
  require_synchronous_promise
} from "./chunk-Z4KEX7YI.js";
import {
  require_dist
} from "./chunk-KYZ4VGBN.js";
import {
  require_lib
} from "./chunk-LZUAKABI.js";
import {
  esm_default,
  require_browser
} from "./chunk-CW55F7I7.js";
import {
  logger,
  require_es_regexp_exec
} from "./chunk-OLVSTUBD.js";
import {
  require_es_array_iterator,
  require_es_string_iterator,
  require_window
} from "./chunk-KSWJJUVF.js";
import {
  __toESM
} from "./chunk-TFWDKVI3.js";

// ../../.yarn/__virtual__/@storybook-client-api-virtual-0860dc9d88/0/cache/@storybook-client-api-npm-6.5.16-4fc55c1f19-a62276fa67.zip/node_modules/@storybook/client-api/dist/esm/ClientApi.js
var import_es_regexp_exec2 = __toESM(require_es_regexp_exec());
var import_es_array_iterator2 = __toESM(require_es_array_iterator());
var import_es_string_iterator2 = __toESM(require_es_string_iterator());
var import_util_deprecate = __toESM(require_browser());
var import_global2 = __toESM(require_window());
var import_csf2 = __toESM(require_dist());

// ../../.yarn/__virtual__/@storybook-client-api-virtual-0860dc9d88/0/cache/@storybook-client-api-npm-6.5.16-4fc55c1f19-a62276fa67.zip/node_modules/@storybook/client-api/dist/esm/StoryStoreFacade.js
var import_es_array_iterator = __toESM(require_es_array_iterator());
var import_es_string_iterator = __toESM(require_es_string_iterator());
var import_es_regexp_exec = __toESM(require_es_regexp_exec());
var import_global = __toESM(require_window());
var import_synchronous_promise = __toESM(require_synchronous_promise());
var import_csf = __toESM(require_dist());
var _excluded = ["default", "__namedExportsOrder"];
var _templateObject;
function _objectWithoutProperties(source, excluded) {
  if (source == null)
    return {};
  var target = _objectWithoutPropertiesLoose(source, excluded);
  var key, i;
  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0)
        continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key))
        continue;
      target[key] = source[key];
    }
  }
  return target;
}
function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null)
    return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;
  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0)
      continue;
    target[key] = source[key];
  }
  return target;
}
function _taggedTemplateLiteral(strings, raw) {
  if (!raw) {
    raw = strings.slice(0);
  }
  return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } }));
}
function _slicedToArray(arr, i) {
  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();
}
function _nonIterableRest() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
function _unsupportedIterableToArray(o, minLen) {
  if (!o)
    return;
  if (typeof o === "string")
    return _arrayLikeToArray(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor)
    n = o.constructor.name;
  if (n === "Map" || n === "Set")
    return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))
    return _arrayLikeToArray(o, minLen);
}
function _arrayLikeToArray(arr, len) {
  if (len == null || len > arr.length)
    len = arr.length;
  for (var i = 0, arr2 = new Array(len); i < len; i++) {
    arr2[i] = arr[i];
  }
  return arr2;
}
function _iterableToArrayLimit(arr, i) {
  var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];
  if (_i == null)
    return;
  var _arr = [];
  var _n = true;
  var _d = false;
  var _s, _e;
  try {
    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);
      if (i && _arr.length === i)
        break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i["return"] != null)
        _i["return"]();
    } finally {
      if (_d)
        throw _e;
    }
  }
  return _arr;
}
function _arrayWithHoles(arr) {
  if (Array.isArray(arr))
    return arr;
}
function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}
function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor)
      descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}
function _createClass(Constructor, protoProps, staticProps) {
  if (protoProps)
    _defineProperties(Constructor.prototype, protoProps);
  if (staticProps)
    _defineProperties(Constructor, staticProps);
  Object.defineProperty(Constructor, "prototype", { writable: false });
  return Constructor;
}
var StoryStoreFacade = function() {
  function StoryStoreFacade2() {
    _classCallCheck(this, StoryStoreFacade2);
    this.projectAnnotations = void 0;
    this.stories = void 0;
    this.csfExports = void 0;
    this.projectAnnotations = {
      loaders: [],
      decorators: [],
      parameters: {},
      argsEnhancers: [],
      argTypesEnhancers: [],
      args: {},
      argTypes: {}
    };
    this.stories = {};
    this.csfExports = {};
  }
  _createClass(StoryStoreFacade2, [{
    key: "importFn",
    value: function importFn(path) {
      var _this = this;
      return import_synchronous_promise.SynchronousPromise.resolve().then(function() {
        var moduleExports = _this.csfExports[path];
        if (!moduleExports)
          throw new Error("Unknown path: ".concat(path));
        return moduleExports;
      });
    }
  }, {
    key: "getStoryIndex",
    value: function getStoryIndex(store) {
      var _this$projectAnnotati, _this$projectAnnotati2, _this2 = this;
      var fileNameOrder = Object.keys(this.csfExports);
      var storySortParameter = (_this$projectAnnotati = this.projectAnnotations.parameters) === null || _this$projectAnnotati === void 0 ? void 0 : (_this$projectAnnotati2 = _this$projectAnnotati.options) === null || _this$projectAnnotati2 === void 0 ? void 0 : _this$projectAnnotati2.storySort;
      var storyEntries = Object.entries(this.stories);
      var sortableV6 = storyEntries.map(function(_ref) {
        var _ref2 = _slicedToArray(_ref, 2), storyId = _ref2[0], importPath = _ref2[1].importPath;
        var exports = _this2.csfExports[importPath];
        var csfFile = store.processCSFFileWithCache(exports, importPath, exports.default.title);
        return [storyId, store.storyFromCSFFile({
          storyId,
          csfFile
        }), csfFile.meta.parameters, _this2.projectAnnotations.parameters];
      });
      var sortedV7;
      try {
        sortedV7 = sortStoriesV6(sortableV6, storySortParameter, fileNameOrder);
      } catch (err) {
        if (typeof storySortParameter === "function") {
          throw new Error(esm_default(_templateObject || (_templateObject = _taggedTemplateLiteral(["\n          Error sorting stories with sort parameter ", ":\n\n          > ", "\n          \n          Are you using a V7-style sort function in V6 compatibility mode?\n          \n          More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#v7-style-story-sort\n        "])), storySortParameter, err.message));
        }
        throw err;
      }
      var stories = sortedV7.reduce(function(acc, s) {
        acc[s.id] = _this2.stories[s.id];
        return acc;
      }, {});
      return {
        v: 3,
        stories
      };
    }
  }, {
    key: "clearFilenameExports",
    value: function clearFilenameExports(fileName) {
      var _this3 = this;
      if (!this.csfExports[fileName]) {
        return;
      }
      Object.entries(this.stories).forEach(function(_ref3) {
        var _ref4 = _slicedToArray(_ref3, 2), id = _ref4[0], importPath = _ref4[1].importPath;
        if (importPath === fileName) {
          delete _this3.stories[id];
        }
      });
      this.csfExports[fileName] = {};
    }
    // NOTE: we could potentially share some of this code with the stories.json generation
  }, {
    key: "addStoriesFromExports",
    value: function addStoriesFromExports(fileName, fileExports) {
      var _this4 = this;
      if (this.csfExports[fileName] === fileExports) {
        return;
      }
      this.clearFilenameExports(fileName);
      var defaultExport = fileExports.default, __namedExportsOrder = fileExports.__namedExportsOrder, namedExports = _objectWithoutProperties(fileExports, _excluded);
      var _ref5 = defaultExport || {}, componentId = _ref5.id, title = _ref5.title;
      var specifiers = (import_global.default.STORIES || []).map(function(specifier) {
        return Object.assign({}, specifier, {
          importPathMatcher: new RegExp(specifier.importPathMatcher)
        });
      });
      title = userOrAutoTitle(fileName, specifiers, title);
      if (!title) {
        logger.info("Unexpected default export without title in '".concat(fileName, "': ").concat(JSON.stringify(fileExports.default)));
        return;
      }
      this.csfExports[fileName] = Object.assign({}, fileExports, {
        default: Object.assign({}, defaultExport, {
          title
        })
      });
      var sortedExports = namedExports;
      if (Array.isArray(__namedExportsOrder)) {
        sortedExports = {};
        __namedExportsOrder.forEach(function(name) {
          var namedExport = namedExports[name];
          if (namedExport)
            sortedExports[name] = namedExport;
        });
      }
      Object.entries(sortedExports).filter(function(_ref6) {
        var _ref7 = _slicedToArray(_ref6, 1), key = _ref7[0];
        return (0, import_csf.isExportStory)(key, defaultExport);
      }).forEach(function(_ref8) {
        var _storyExport$paramete, _storyExport$story;
        var _ref9 = _slicedToArray(_ref8, 2), key = _ref9[0], storyExport = _ref9[1];
        var exportName = (0, import_csf.storyNameFromExport)(key);
        var id = ((_storyExport$paramete = storyExport.parameters) === null || _storyExport$paramete === void 0 ? void 0 : _storyExport$paramete.__id) || (0, import_csf.toId)(componentId || title, exportName);
        var name = typeof storyExport !== "function" && storyExport.name || storyExport.storyName || ((_storyExport$story = storyExport.story) === null || _storyExport$story === void 0 ? void 0 : _storyExport$story.name) || exportName;
        _this4.stories[id] = {
          id,
          name,
          title,
          importPath: fileName
        };
      });
    }
  }]);
  return StoryStoreFacade2;
}();

// ../../.yarn/__virtual__/@storybook-client-api-virtual-0860dc9d88/0/cache/@storybook-client-api-npm-6.5.16-4fc55c1f19-a62276fa67.zip/node_modules/@storybook/client-api/dist/esm/ClientApi.js
var _excluded2 = ["globals", "globalTypes"];
var _excluded22 = ["decorators", "loaders", "component", "args", "argTypes"];
var _excluded3 = ["component", "args", "argTypes"];
var _templateObject2;
var _templateObject22;
var _templateObject3;
var _templateObject4;
function _slicedToArray2(arr, i) {
  return _arrayWithHoles2(arr) || _iterableToArrayLimit2(arr, i) || _unsupportedIterableToArray2(arr, i) || _nonIterableRest2();
}
function _nonIterableRest2() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
function _unsupportedIterableToArray2(o, minLen) {
  if (!o)
    return;
  if (typeof o === "string")
    return _arrayLikeToArray2(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor)
    n = o.constructor.name;
  if (n === "Map" || n === "Set")
    return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))
    return _arrayLikeToArray2(o, minLen);
}
function _arrayLikeToArray2(arr, len) {
  if (len == null || len > arr.length)
    len = arr.length;
  for (var i = 0, arr2 = new Array(len); i < len; i++) {
    arr2[i] = arr[i];
  }
  return arr2;
}
function _iterableToArrayLimit2(arr, i) {
  var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];
  if (_i == null)
    return;
  var _arr = [];
  var _n = true;
  var _d = false;
  var _s, _e;
  try {
    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);
      if (i && _arr.length === i)
        break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i["return"] != null)
        _i["return"]();
    } finally {
      if (_d)
        throw _e;
    }
  }
  return _arr;
}
function _arrayWithHoles2(arr) {
  if (Array.isArray(arr))
    return arr;
}
function _typeof(obj) {
  "@babel/helpers - typeof";
  return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(obj2) {
    return typeof obj2;
  } : function(obj2) {
    return obj2 && "function" == typeof Symbol && obj2.constructor === Symbol && obj2 !== Symbol.prototype ? "symbol" : typeof obj2;
  }, _typeof(obj);
}
function _objectWithoutProperties2(source, excluded) {
  if (source == null)
    return {};
  var target = _objectWithoutPropertiesLoose2(source, excluded);
  var key, i;
  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0)
        continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key))
        continue;
      target[key] = source[key];
    }
  }
  return target;
}
function _objectWithoutPropertiesLoose2(source, excluded) {
  if (source == null)
    return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;
  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0)
      continue;
    target[key] = source[key];
  }
  return target;
}
function _classCallCheck2(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}
function _defineProperties2(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor)
      descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}
function _createClass2(Constructor, protoProps, staticProps) {
  if (protoProps)
    _defineProperties2(Constructor.prototype, protoProps);
  if (staticProps)
    _defineProperties2(Constructor, staticProps);
  Object.defineProperty(Constructor, "prototype", { writable: false });
  return Constructor;
}
function _taggedTemplateLiteral2(strings, raw) {
  if (!raw) {
    raw = strings.slice(0);
  }
  return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } }));
}
var singleton;
var warningAlternatives = {
  addDecorator: "Instead, use `export const decorators = [];` in your `preview.js`.",
  addParameters: "Instead, use `export const parameters = {};` in your `preview.js`.",
  addLoaders: "Instead, use `export const loaders = [];` in your `preview.js`."
};
var warningMessage = function warningMessage2(method) {
  return (0, import_util_deprecate.default)(function() {
  }, esm_default(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral2(["\n  `", "` is deprecated, and will be removed in Storybook 7.0.\n\n  ", "\n\n  Read more at https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-addparameters-and-adddecorator)."], ["\n  \\`", "\\` is deprecated, and will be removed in Storybook 7.0.\n\n  ", "\n\n  Read more at https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-addparameters-and-adddecorator)."])), method, warningAlternatives[method]));
};
var warnings = {
  addDecorator: warningMessage("addDecorator"),
  addParameters: warningMessage("addParameters"),
  addLoaders: warningMessage("addLoaders")
};
var checkMethod = function checkMethod2(method, deprecationWarning) {
  var _global$FEATURES;
  if ((_global$FEATURES = import_global2.default.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7) {
    throw new Error(esm_default(_templateObject22 || (_templateObject22 = _taggedTemplateLiteral2(["You cannot use `", "` with the new Story Store.\n      \n      ", ""], ["You cannot use \\`", "\\` with the new Story Store.\n      \n      ", ""])), method, warningAlternatives[method]));
  }
  if (!singleton) {
    throw new Error("Singleton client API not yet initialized, cannot call `".concat(method, "`."));
  }
  if (deprecationWarning) {
    warnings[method]();
  }
};
var addDecorator = function addDecorator2(decorator) {
  var deprecationWarning = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : true;
  checkMethod("addDecorator", deprecationWarning);
  singleton.addDecorator(decorator);
};
var addParameters = function addParameters2(parameters) {
  var deprecationWarning = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : true;
  checkMethod("addParameters", deprecationWarning);
  singleton.addParameters(parameters);
};
var addLoader = function addLoader2(loader) {
  var deprecationWarning = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : true;
  checkMethod("addLoader", deprecationWarning);
  singleton.addLoader(loader);
};
var addArgs = function addArgs2(args) {
  checkMethod("addArgs", false);
  singleton.addArgs(args);
};
var addArgTypes = function addArgTypes2(argTypes) {
  checkMethod("addArgTypes", false);
  singleton.addArgTypes(argTypes);
};
var addArgsEnhancer = function addArgsEnhancer2(enhancer) {
  checkMethod("addArgsEnhancer", false);
  singleton.addArgsEnhancer(enhancer);
};
var addArgTypesEnhancer = function addArgTypesEnhancer2(enhancer) {
  checkMethod("addArgTypesEnhancer", false);
  singleton.addArgTypesEnhancer(enhancer);
};
var setGlobalRender = function setGlobalRender2(render) {
  checkMethod("setGlobalRender", false);
  singleton.facade.projectAnnotations.render = render;
};
var invalidStoryTypes = /* @__PURE__ */ new Set(["string", "number", "boolean", "symbol"]);
var ClientApi = function() {
  function ClientApi2() {
    var _this = this;
    var _ref = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, storyStore = _ref.storyStore;
    _classCallCheck2(this, ClientApi2);
    this.facade = void 0;
    this.storyStore = void 0;
    this.addons = void 0;
    this.onImportFnChanged = void 0;
    this.lastFileName = 0;
    this.setAddon = (0, import_util_deprecate.default)(function(addon) {
      _this.addons = Object.assign({}, _this.addons, addon);
    }, esm_default(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral2(["\n      `setAddon` is deprecated and will be removed in Storybook 7.0.\n\n      https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-setaddon\n    "], ["\n      \\`setAddon\\` is deprecated and will be removed in Storybook 7.0.\n\n      https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-setaddon\n    "]))));
    this.addDecorator = function(decorator) {
      _this.facade.projectAnnotations.decorators.push(decorator);
    };
    this.clearDecorators = (0, import_util_deprecate.default)(function() {
      _this.facade.projectAnnotations.decorators = [];
    }, esm_default(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral2(["\n      `clearDecorators` is deprecated and will be removed in Storybook 7.0.\n\n      https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-cleardecorators\n    "], ["\n      \\`clearDecorators\\` is deprecated and will be removed in Storybook 7.0.\n\n      https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-cleardecorators\n    "]))));
    this.addParameters = function(_ref2) {
      var globals = _ref2.globals, globalTypes = _ref2.globalTypes, parameters = _objectWithoutProperties2(_ref2, _excluded2);
      _this.facade.projectAnnotations.parameters = combineParameters(_this.facade.projectAnnotations.parameters, parameters);
      if (globals) {
        _this.facade.projectAnnotations.globals = Object.assign({}, _this.facade.projectAnnotations.globals, globals);
      }
      if (globalTypes) {
        _this.facade.projectAnnotations.globalTypes = Object.assign({}, _this.facade.projectAnnotations.globalTypes, normalizeInputTypes(globalTypes));
      }
    };
    this.addLoader = function(loader) {
      _this.facade.projectAnnotations.loaders.push(loader);
    };
    this.addArgs = function(args) {
      _this.facade.projectAnnotations.args = Object.assign({}, _this.facade.projectAnnotations.args, args);
    };
    this.addArgTypes = function(argTypes) {
      _this.facade.projectAnnotations.argTypes = Object.assign({}, _this.facade.projectAnnotations.argTypes, normalizeInputTypes(argTypes));
    };
    this.addArgsEnhancer = function(enhancer) {
      _this.facade.projectAnnotations.argsEnhancers.push(enhancer);
    };
    this.addArgTypesEnhancer = function(enhancer) {
      _this.facade.projectAnnotations.argTypesEnhancers.push(enhancer);
    };
    this.storiesOf = function(kind, m) {
      if (!kind && typeof kind !== "string") {
        throw new Error("Invalid or missing kind provided for stories, should be a string");
      }
      if (!m) {
        logger.warn("Missing 'module' parameter for story with a kind of '".concat(kind, "'. It will break your HMR"));
      }
      if (m) {
        var proto = Object.getPrototypeOf(m);
        if (proto.exports && proto.exports.default) {
          logger.error("Illegal mix of CSF default export and storiesOf calls in a single file: ".concat(proto.i));
        }
      }
      var baseFilename = m && m.id ? "".concat(m.id) : (_this.lastFileName++).toString();
      var fileName = baseFilename;
      var i = 1;
      while (_this.facade.csfExports[fileName] && Object.keys(_this.facade.csfExports[fileName]).length > 0) {
        i += 1;
        fileName = "".concat(baseFilename, "-").concat(i);
      }
      if (m && m.hot && m.hot.accept) {
        m.hot.accept();
        m.hot.dispose(function() {
          _this.facade.clearFilenameExports(fileName);
          setTimeout(function() {
            var _this$onImportFnChang;
            (_this$onImportFnChang = _this.onImportFnChanged) === null || _this$onImportFnChang === void 0 ? void 0 : _this$onImportFnChang.call(_this, {
              importFn: _this.importFn.bind(_this)
            });
          }, 0);
        });
      }
      var hasAdded = false;
      var api = {
        kind: kind.toString(),
        add: function add() {
          return api;
        },
        addDecorator: function addDecorator3() {
          return api;
        },
        addLoader: function addLoader3() {
          return api;
        },
        addParameters: function addParameters3() {
          return api;
        }
      };
      Object.keys(_this.addons).forEach(function(name) {
        var addon = _this.addons[name];
        api[name] = function() {
          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
            args[_key] = arguments[_key];
          }
          addon.apply(api, args);
          return api;
        };
      });
      var meta = {
        id: (0, import_csf2.sanitize)(kind),
        title: kind,
        decorators: [],
        loaders: [],
        parameters: {}
      };
      _this.facade.csfExports[fileName] = {
        default: meta
      };
      var counter = 0;
      api.add = function(storyName, storyFn) {
        var parameters = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
        hasAdded = true;
        if (typeof storyName !== "string") {
          throw new Error('Invalid or missing storyName provided for a "'.concat(kind, '" story.'));
        }
        if (!storyFn || Array.isArray(storyFn) || invalidStoryTypes.has(_typeof(storyFn))) {
          throw new Error('Cannot load story "'.concat(storyName, '" in "').concat(kind, '" due to invalid format. Storybook expected a function/object but received ').concat(_typeof(storyFn), " instead."));
        }
        var decorators = parameters.decorators, loaders = parameters.loaders, component = parameters.component, args = parameters.args, argTypes = parameters.argTypes, storyParameters = _objectWithoutProperties2(parameters, _excluded22);
        var storyId = parameters.__id || (0, import_csf2.toId)(kind, storyName);
        var csfExports = _this.facade.csfExports[fileName];
        csfExports["story".concat(counter)] = {
          name: storyName,
          parameters: Object.assign({
            fileName,
            __id: storyId
          }, storyParameters),
          decorators,
          loaders,
          args,
          argTypes,
          component,
          render: storyFn
        };
        counter += 1;
        _this.facade.stories[storyId] = {
          id: storyId,
          title: csfExports.default.title,
          name: storyName,
          importPath: fileName
        };
        return api;
      };
      api.addDecorator = function(decorator) {
        if (hasAdded)
          throw new Error("You cannot add a decorator after the first story for a kind.\nRead more here: https://github.com/storybookjs/storybook/blob/master/MIGRATION.md#can-no-longer-add-decoratorsparameters-after-stories");
        meta.decorators.push(decorator);
        return api;
      };
      api.addLoader = function(loader) {
        if (hasAdded)
          throw new Error("You cannot add a loader after the first story for a kind.");
        meta.loaders.push(loader);
        return api;
      };
      api.addParameters = function(_ref3) {
        var component = _ref3.component, args = _ref3.args, argTypes = _ref3.argTypes, parameters = _objectWithoutProperties2(_ref3, _excluded3);
        if (hasAdded)
          throw new Error("You cannot add parameters after the first story for a kind.\nRead more here: https://github.com/storybookjs/storybook/blob/master/MIGRATION.md#can-no-longer-add-decoratorsparameters-after-stories");
        meta.parameters = combineParameters(meta.parameters, parameters);
        if (component)
          meta.component = component;
        if (args)
          meta.args = Object.assign({}, meta.args, args);
        if (argTypes)
          meta.argTypes = Object.assign({}, meta.argTypes, argTypes);
        return api;
      };
      return api;
    };
    this.getStorybook = function() {
      var stories = _this.storyStore.storyIndex.stories;
      var kinds = {};
      Object.entries(stories).forEach(function(_ref4) {
        var _ref5 = _slicedToArray2(_ref4, 2), storyId = _ref5[0], _ref5$ = _ref5[1], title = _ref5$.title, name = _ref5$.name, importPath = _ref5$.importPath;
        if (!kinds[title]) {
          kinds[title] = {
            kind: title,
            fileName: importPath,
            stories: []
          };
        }
        var _this$storyStore$from = _this.storyStore.fromId(storyId), storyFn = _this$storyStore$from.storyFn;
        kinds[title].stories.push({
          name,
          render: storyFn
        });
      });
      return Object.values(kinds);
    };
    this.raw = function() {
      return _this.storyStore.raw();
    };
    this.facade = new StoryStoreFacade();
    this.addons = {};
    this.storyStore = storyStore;
    singleton = this;
  }
  _createClass2(ClientApi2, [{
    key: "importFn",
    value: function importFn(path) {
      return this.facade.importFn(path);
    }
  }, {
    key: "getStoryIndex",
    value: function getStoryIndex() {
      if (!this.storyStore) {
        throw new Error("Cannot get story index before setting storyStore");
      }
      return this.facade.getStoryIndex(this.storyStore);
    }
  }, {
    key: "_storyStore",
    get: (
      // @deprecated
      function get() {
        return this.storyStore;
      }
    )
  }]);
  return ClientApi2;
}();

// ../../.yarn/__virtual__/@storybook-client-api-virtual-0860dc9d88/0/cache/@storybook-client-api-npm-6.5.16-4fc55c1f19-a62276fa67.zip/node_modules/@storybook/client-api/dist/esm/queryparams.js
var import_es_regexp_exec3 = __toESM(require_es_regexp_exec());
var import_global3 = __toESM(require_window());
var import_qs = __toESM(require_lib());
var document = import_global3.default.document;
var getQueryParams = function getQueryParams2() {
  if (document && document.location && document.location.search) {
    return (0, import_qs.parse)(document.location.search, {
      ignoreQueryPrefix: true
    });
  }
  return {};
};
var getQueryParam = function getQueryParam2(key) {
  var params = getQueryParams();
  return params[key];
};

export {
  addDecorator,
  addParameters,
  addLoader,
  addArgs,
  addArgTypes,
  addArgsEnhancer,
  addArgTypesEnhancer,
  setGlobalRender,
  ClientApi,
  getQueryParams,
  getQueryParam
};
//# sourceMappingURL=chunk-44D2M67O.js.map
